(()=>{"use strict";const e=e=>"#"===e[0]?document.getElementById(e.slice(1)):document.querySelectorAll(e),t=window.wp.i18n,s=window.wp.url,r=function(t,s){const r=`save-changes-${Date.now()}`,a=e("#spinner-save-changes");a.parentNode.insertAdjacentHTML("afterend",`<div id="${r}" class="ajax-alert notice notice-${t}"><p>${s}</p></div>`),a.remove();const n=e(`#${r}`);n.offsetWidth,n.style.opacity=0,n.addEventListener("transitionend",(()=>n.remove())),e(".button-save-changes").forEach((e=>e.disabled=!1)),document.body.classList.remove("wait")},a=function(){Object.keys(tp.access_rights_map).forEach((t=>{Object.keys(tp.access_rights_map[t]).forEach((s=>{const r=tp.access_rights_map[t][s];e(`#tp-aar-${t}-${s}`).checked=1===r}))}))};let n;a(),e("#tablepress-page").addEventListener("click",(a=>{a.target&&a.target.matches(".button-save-changes")&&function(a,n){a.target.parentNode.insertAdjacentHTML("beforeend",`<span id="spinner-save-changes" class="spinner-save-changes spinner is-active" title="${(0,t.__)("Changes are being saved â€¦","tablepress")}"/>`),e(".button-save-changes").forEach((e=>e.disabled=!0)),document.body.classList.add("wait"),fetch(ajaxurl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:(0,s.buildQueryString)(n)}).then((e=>{if(!e.ok)throw new Error(`There was a problem with the server, HTTP response code ${e.status} (${e.statusText}).`);return e.json()})).then((e=>{if(null==e||"-1"===e||void 0===e.success)throw new Error("The JSON data returned from the server is unclear or incomplete.");if(!0!==e.success){const t=e.error_details?`</p><p>These errors were encountered:</p><pre>${e.error_details}</pre><p>`:"";throw new Error(`The data could not be saved to the database properly.${t}`)}!function(e){const s={success_save:(0,t.__)("The changes were saved successfully.","tablepress"),error_save:(0,t.__)("Attention: Unfortunately, an error occurred.","tablepress")},a=e.message.includes("error")?"error":"success";r(a,s[e.message])}(e)})).catch((e=>{return s=e.message,s=(0,t.__)("Attention: Unfortunately, an error occurred.","tablepress")+" "+s,void r("error",s);var s}))}(a,{action:"tablepress_advanced_access_rights",_ajax_nonce:e("#_wpnonce").value,tablepress:JSON.stringify(tp.access_rights_map)})})),e("#tablepress-access-rights-map").addEventListener("click",(function(e){if(e.target&&e.target instanceof HTMLInputElement&&"checkbox"===e.target.type){const t=Object.keys(tp.access_rights_map),s=Object.keys(tp.access_rights_map[t[0]]),r={table_id:t.indexOf(e.target.dataset.tableId),user_id:s.indexOf(e.target.dataset.userId)};n&&void 0!==e.shiftKey&&e.shiftKey||(n=r);const c={table_id:n.table_id<r.table_id?n.table_id:r.table_id,user_id:n.user_id<r.user_id?n.user_id:r.user_id},i={table_id:r.table_id>n.table_id?r.table_id:n.table_id,user_id:r.user_id>n.user_id?r.user_id:n.user_id};for(let r=c.table_id;r<=i.table_id;r++)for(let a=c.user_id;a<=i.user_id;a++){const n=t[r],c=s[a];tp.access_rights_map[n][c]=e.target.checked?1:0}return n=r,void a()}}))})();