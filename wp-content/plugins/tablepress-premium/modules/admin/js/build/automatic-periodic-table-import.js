(()=>{"use strict";const e=e=>"#"===e[0]?document.getElementById(e.slice(1)):document.querySelectorAll(e),t=window.wp.i18n,r=window.wp.url,a=function(t,r){const a=`save-changes-${Date.now()}`,s=e("#spinner-save-changes");s.parentNode.insertAdjacentHTML("afterend",`<div id="${a}" class="ajax-alert notice notice-${t}"><p>${r}</p></div>`),s.remove();const o=e(`#${a}`);o.offsetWidth,o.style.opacity=0,o.addEventListener("transitionend",(()=>o.remove())),e(".button-save-changes").forEach((e=>e.disabled=!1)),document.body.classList.remove("wait")};e("#tablepress_import-tables-auto-import").addEventListener("click",(s=>{if(s.target&&s.target.matches(".button-save-changes")){const o={schedule:e("#auto-import-schedule").value,tables:{}};document.querySelectorAll("#tablepress-automatic-periodic-import-tables > tbody > tr").forEach((e=>{const t=e.dataset.tableId,r=e.querySelector(".cb_auto_import_active").checked,a=e.querySelector(".select_auto_import_source").value,s=e.querySelector(".input_auto_import_location").value;(r||"url"!==a||"https://"!==s)&&(o.tables[t]={active:r,source:a,location:s})})),function(s,o){s.target.parentNode.insertAdjacentHTML("beforeend",`<span id="spinner-save-changes" class="spinner-save-changes spinner is-active" title="${(0,t.__)("Changes are being saved â€¦","tablepress")}"/>`),e(".button-save-changes").forEach((e=>e.disabled=!0)),document.body.classList.add("wait"),fetch(ajaxurl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:(0,r.buildQueryString)(o)}).then((e=>{if(!e.ok)throw new Error(`There was a problem with the server, HTTP response code ${e.status} (${e.statusText}).`);return e.json()})).then((e=>{if(null==e||"-1"===e||void 0===e.success)throw new Error("The JSON data returned from the server is unclear or incomplete.");if(!0!==e.success){const t=e.error_details?`</p><p>These errors were encountered:</p><pre>${e.error_details}</pre><p>`:"";throw new Error(`The data could not be saved to the database properly.${t}`)}!function(e){const r={success_save:(0,t.__)("The changes were saved successfully.","tablepress"),error_save:(0,t.__)("Attention: Unfortunately, an error occurred.","tablepress")},s=e.message.includes("error")?"error":"success";a(s,r[e.message])}(e)})).catch((e=>{return r=e.message,r=(0,t.__)("Attention: Unfortunately, an error occurred.","tablepress")+" "+r,void a("error",r);var r}))}(s,{action:"tablepress_import",_ajax_nonce:e("#_wpnonce").value,tablepress:JSON.stringify(o)})}})),e("#tablepress-automatic-periodic-import-tables").addEventListener("change",(e=>{if(e.target&&(e.target instanceof HTMLInputElement&&"checkbox"===e.target.type&&s(),e.target.matches(".select_auto_import_source"))){const t=e.target.closest("tr").querySelector(".input_auto_import_location"),r=t.value,a=e.target.value;"url"===a&&tp.abspath===r?t.value="https://":"server"===a&&"https://"===r&&(t.value=tp.abspath)}}));const s=function(){document.querySelectorAll("#tablepress-automatic-periodic-import-tables > tbody > tr").forEach((e=>{const t=!e.querySelector(".cb_auto_import_active").checked;e.querySelectorAll(":scope .select_auto_import_source, :scope .input_auto_import_location").forEach((e=>e.disabled=t))}))};s()})();